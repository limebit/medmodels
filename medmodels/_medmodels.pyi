from typing import Dict, List, Optional, Union

from polars import DataFrame

from medmodels.medrecord.types import (
    Attributes,
    EdgeIndex,
    Group,
    MedRecordAttribute,
    MedRecordValue,
    NodeIndex,
)

ValueOperand = Union[
    MedRecordValue,
    MedRecordAttribute,
    PyValueArithmeticOperation,
    PyValueTransformationOperation,
]

class PyMedRecord:
    nodes: List[NodeIndex]
    edges: List[EdgeIndex]
    groups: List[Group]

    def __init__(self) -> None: ...
    @staticmethod
    def from_tuples(
        nodes: List[tuple[NodeIndex, Attributes]],
        edges: Optional[List[tuple[NodeIndex, NodeIndex, Attributes]]],
    ) -> PyMedRecord: ...
    @staticmethod
    def from_dataframes(
        nodes_dataframe: DataFrame,
        nodes_index_column_name: str,
        edges_dataframe: DataFrame,
        edges_from_index_column_name: str,
        edges_to_index_column_name: str,
    ) -> PyMedRecord: ...
    @staticmethod
    def from_nodes_dataframe(
        nodes_dataframe: DataFrame,
        nodes_index_column_name: str,
    ) -> PyMedRecord: ...
    def node(self, *node_index: NodeIndex) -> Dict[NodeIndex, Attributes]: ...
    def edge(self, *edge_index: EdgeIndex) -> Dict[EdgeIndex, Attributes]: ...
    def group(self, *group: Group) -> Dict[Group, List[NodeIndex]]: ...
    def outgoing_edges(
        self, *node_index: NodeIndex
    ) -> Dict[NodeIndex, List[EdgeIndex]]: ...
    def incoming_edges(
        self, *node_index: NodeIndex
    ) -> Dict[NodeIndex, List[EdgeIndex]]: ...
    def edge_endpoints(
        self, *edge_index: EdgeIndex
    ) -> Dict[EdgeIndex, tuple[NodeIndex, NodeIndex]]: ...
    def edges_connecting(
        self, source_node_index: NodeIndex, target_node_index: NodeIndex
    ) -> List[EdgeIndex]: ...
    def add_node(self, node_index: NodeIndex, attributes: Attributes) -> None: ...
    def remove_node(self, *node_index: NodeIndex) -> Dict[NodeIndex, Attributes]: ...
    def add_nodes(self, nodes: List[tuple[NodeIndex, Attributes]]) -> None: ...
    def add_nodes_dataframe(
        self, nodes_dataframe: DataFrame, index_column_name: str
    ) -> None: ...
    def add_edge(
        self,
        source_node_index: NodeIndex,
        target_node_index: NodeIndex,
        attributes: Attributes,
    ) -> EdgeIndex: ...
    def remove_edge(self, *edge_index: EdgeIndex) -> Dict[EdgeIndex, Attributes]: ...
    def add_edges(
        self, edges: List[tuple[NodeIndex, NodeIndex, Attributes]]
    ) -> List[EdgeIndex]: ...
    def add_edges_dataframe(
        self,
        edges_dataframe: DataFrame,
        from_index_column_name: str,
        to_index_column_name: str,
    ) -> List[EdgeIndex]: ...
    def add_group(
        self, group: Group, node_indices_to_add: Optional[List[NodeIndex]]
    ) -> None: ...
    def remove_group(self, *group: Group) -> None: ...
    def add_node_to_group(self, group: Group, *node_index: NodeIndex) -> None: ...
    def remove_node_from_group(self, group: Group, *node_index: NodeIndex) -> None: ...
    def groups_of_node(
        self, *node_index: NodeIndex
    ) -> Dict[NodeIndex, List[Group]]: ...
    def node_count(self) -> int: ...
    def edge_count(self) -> int: ...
    def group_count(self) -> int: ...
    def contains_node(self, node_index: NodeIndex) -> bool: ...
    def contains_edge(self, edge_index: EdgeIndex) -> bool: ...
    def contains_group(self, group: Group) -> bool: ...
    def neighbors(self, *node_index: NodeIndex) -> Dict[NodeIndex, List[NodeIndex]]: ...
    def clear() -> None: ...
    def select_nodes(self, operation: PyNodeOperation) -> List[NodeIndex]: ...
    def select_edges(self, operation: PyEdgeOperation) -> List[EdgeIndex]: ...

class PyValueArithmeticOperation: ...
class PyValueTransformationOperation: ...

class PyNodeOperation:
    def logical_and(self, operation: PyNodeOperation) -> PyNodeOperation: ...
    def logical_or(self, operation: PyNodeOperation) -> PyNodeOperation: ...
    def logical_xor(self, operation: PyNodeOperation) -> PyNodeOperation: ...
    def logical_not(self, operation: PyNodeOperation) -> PyNodeOperation: ...

class PyEdgeOperation:
    def logical_and(self, operation: PyEdgeOperation) -> PyEdgeOperation: ...
    def logical_or(self, operation: PyEdgeOperation) -> PyEdgeOperation: ...
    def logical_xor(self, operation: PyEdgeOperation) -> PyEdgeOperation: ...
    def logical_not(self, operation: PyEdgeOperation) -> PyEdgeOperation: ...

class PyNodeAttributeOperand:
    def greater(self, operand: ValueOperand) -> PyNodeOperation: ...
    def less(self, operand: ValueOperand) -> PyNodeOperation: ...
    def greater_or_equal(self, operand: ValueOperand) -> PyNodeOperation: ...
    def less_or_equal(self, operand: ValueOperand) -> PyNodeOperation: ...
    def equal(self, operand: ValueOperand) -> PyNodeOperation: ...
    def not_equal(self, operand: ValueOperand) -> PyNodeOperation: ...
    def is_in(self, operands: List[MedRecordValue]) -> PyNodeOperation: ...
    def not_in(self, operands: List[MedRecordValue]) -> PyNodeOperation: ...
    def starts_with(self, operand: ValueOperand) -> PyNodeOperation: ...
    def ends_with(self, operand: ValueOperand) -> PyNodeOperation: ...
    def contains(self, operand: ValueOperand) -> PyNodeOperation: ...
    def add(self, value: MedRecordValue) -> ValueOperand: ...
    def sub(self, value: MedRecordValue) -> ValueOperand: ...
    def mul(self, value: MedRecordValue) -> ValueOperand: ...
    def div(self, value: MedRecordValue) -> ValueOperand: ...
    def pow(self, value: MedRecordValue) -> ValueOperand: ...
    def mod(self, value: MedRecordValue) -> ValueOperand: ...
    def round(self) -> ValueOperand: ...
    def ceil(self) -> ValueOperand: ...
    def floor(self) -> ValueOperand: ...
    def abs(self) -> ValueOperand: ...
    def sqrt(self) -> ValueOperand: ...
    def trim(self) -> ValueOperand: ...
    def trim_start(self) -> ValueOperand: ...
    def trim_end(self) -> ValueOperand: ...
    def lowercase(self) -> ValueOperand: ...
    def uppercase(self) -> ValueOperand: ...
    def slice(self, start: int, end: int) -> ValueOperand: ...

class PyEdgeAttributeOperand:
    def greater(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def less(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def greater_or_equal(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def less_or_equal(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def equal(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def not_equal(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def is_in(self, operands: List[MedRecordValue]) -> PyEdgeOperation: ...
    def not_in(self, operands: List[MedRecordValue]) -> PyEdgeOperation: ...
    def starts_with(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def ends_with(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def contains(self, operand: ValueOperand) -> PyEdgeOperation: ...
    def add(self, value: MedRecordValue) -> ValueOperand: ...
    def sub(self, value: MedRecordValue) -> ValueOperand: ...
    def mul(self, value: MedRecordValue) -> ValueOperand: ...
    def div(self, value: MedRecordValue) -> ValueOperand: ...
    def pow(self, value: MedRecordValue) -> ValueOperand: ...
    def mod(self, value: MedRecordValue) -> ValueOperand: ...
    def round(self) -> ValueOperand: ...
    def ceil(self) -> ValueOperand: ...
    def floor(self) -> ValueOperand: ...
    def abs(self) -> ValueOperand: ...
    def sqrt(self) -> ValueOperand: ...
    def trim(self) -> ValueOperand: ...
    def trim_start(self) -> ValueOperand: ...
    def trim_end(self) -> ValueOperand: ...
    def lowercase(self) -> ValueOperand: ...
    def uppercase(self) -> ValueOperand: ...
    def slice(self, start: int, end: int) -> ValueOperand: ...

class PyNodeIndexOperand:
    def greater(self, operand: NodeIndex) -> PyNodeOperation: ...
    def less(self, operand: NodeIndex) -> PyNodeOperation: ...
    def greater_or_equal(self, operand: NodeIndex) -> PyNodeOperation: ...
    def less_or_equal(self, operand: NodeIndex) -> PyNodeOperation: ...
    def equal(self, operand: NodeIndex) -> PyNodeOperation: ...
    def not_equal(self, operand: NodeIndex) -> PyNodeOperation: ...
    def is_in(self, operand: List[NodeIndex]) -> PyNodeOperation: ...
    def not_in(self, operand: List[NodeIndex]) -> PyNodeOperation: ...
    def starts_with(self, operand: NodeIndex) -> PyNodeOperation: ...
    def ends_with(self, operand: NodeIndex) -> PyNodeOperation: ...
    def contains(self, operand: NodeIndex) -> PyNodeOperation: ...

class PyEdgeIndexOperand:
    def greater(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def less(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def greater_or_equal(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def less_or_equal(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def equal(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def not_equal(self, operand: EdgeIndex) -> PyEdgeOperation: ...
    def is_in(self, operand: List[EdgeIndex]) -> PyEdgeOperation: ...
    def not_in(self, operand: List[EdgeIndex]) -> PyEdgeOperation: ...

class PyNodeOperand:
    def in_group(self, operand: Group) -> PyNodeOperation: ...
    def has_attribute(self, operand: MedRecordAttribute) -> PyNodeOperation: ...
    def has_outgoing_edge_with(self, operation: PyEdgeOperation) -> PyNodeOperation: ...
    def has_incoming_edge_with(self, operation: PyEdgeOperation) -> PyNodeOperation: ...
    def has_edge_with(self, operation: PyEdgeOperation) -> PyNodeOperation: ...
    def has_neighbor_with(self, operation: PyNodeOperation) -> PyNodeOperation: ...
    def attribute(self, attribute: MedRecordAttribute) -> PyNodeAttributeOperand: ...
    def index(self) -> PyNodeIndexOperand: ...

class PyEdgeOperand:
    def connected_target(self, operand: NodeIndex) -> PyEdgeOperation: ...
    def connected_source(self, operand: NodeIndex) -> PyEdgeOperation: ...
    def connected(self, operand: NodeIndex) -> PyEdgeOperation: ...
    def has_attribute(self, operand: MedRecordAttribute) -> PyEdgeOperation: ...
    def connected_source_with(self, operation: PyNodeOperation) -> PyEdgeOperation: ...
    def connected_target_with(self, operation: PyNodeOperation) -> PyEdgeOperation: ...
    def connected_with(self, operation: PyNodeOperation) -> PyEdgeOperation: ...
    def has_parallel_edges_with(
        self, operation: PyEdgeOperation
    ) -> PyEdgeOperation: ...
    def has_parallel_edges_with_self_comparison(
        self, operation: PyEdgeOperation
    ) -> PyEdgeOperation: ...
    def attribute(self, attribute: MedRecordAttribute) -> PyEdgeAttributeOperand: ...
    def index(self) -> PyEdgeIndexOperand: ...
